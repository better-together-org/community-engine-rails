<!-- app/views/conversations/_conversation_content.html.erb -->
<div id="<%= dom_id(conversation) %>"
	class="conversation-details card shadow-sm d-flex flex-column justify-content-between">
	<div class="position-relative">
		<div class="card-header bg-secondary text-white text-center d-flex align-items-center px-2 rounded-0">
			<a class="text-decoration-none align-self-start p-4" href="<%= conversations_path %>">
				<i class="fas fa-arrow-left fa-2x "></i>
			</a>
			<% if conversation.title.present? %>
				<h4 class="m-0 me-4 align-self-center">
					<%= conversation.title %>
				</h4>
				<% end %>
					<div class="conversation-participants w-100 d-flex align-items-top justify-content-evenly overflow-auto">
						<%= render partial: 'better_together/people/mention' , collection: conversation.participants, as: :person,
							locals: { flex_layout: 'flex-column' , flex_align_items: 'center' } %>
					</div>
					<div data-bs-toggle="tooltip" title="Conversation Options" class="align-self-start me-4">
						<a class="text-white" href="#" data-bs-toggle="dropdown">
							<i class="fas fa-xl fa-ellipsis"></i>
						</a>
						<ul class="dropdown-menu p-2">
							<li>
								<button class="btn" data-bs-toggle="collapse" data-bs-target="#edit_conversation">
									<i class="fas fa-pencil me-1"></i>
									<%= t('.edit_conversation') %>
								</button>
							</li>
							<li>
								<button class="btn">
									<i class="fas fa-arrow-right-from-bracket me-1"></i>
									Leave Conversation
								</button>
							</li>
							<li>
								<hr class="dropdown-divider">
							</li>
							<li>
								<button class="btn text-danger" data-bs-toggle="collapse" data-bs-target="#edit_conversation">
									<i class="fas fa-trash-can me-1"></i>
									Delete Conversation
								</button>
							</li>
						</ul>
					</div>
		</div>
		<div id="edit_conversation"
			class="collapse bg-secondary text-white px-2 py-3 position-absolute top-100 w-100 rounded-bottom"
			style="z-index: 100;">
			<%= render "form" , conversation: @conversation %>
		</div>
	</div>

	<%= turbo_stream_from conversation %>

		<div id="conversation_messages" class="card-body p-4" data-controller="better_together--conversation-messages"
			data-better_together--conversation-messages-current-person-id-value="<%= current_person.id %>">
			<%= render(partial: 'better_together/messages/message' , collection: messages, as: :message, locals:
				{read_status: 'read' }) || render(partial: 'better_together/conversations/empty' , locals: { conversation: }) %>
		</div>

		<div class="card-footer">
			<%= render partial: 'better_together/messages/form' , locals: { conversation: conversation, message: message } %>
		</div>
</div>