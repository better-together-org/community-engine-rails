<div class="col" id="<%= dom_id(role) %>">
  <div class="card h-100 shadow-sm">
    <div class="card-body">
      <div class="d-flex justify-content-between align-items-start mb-2">
        <div>
          <h3 class="h5 mb-1"><%= role.name %></h3>
          <p class="text-muted small mb-0"><%= role.identifier %></p>
        </div>
        <span class="badge <%= role.protected? ? 'bg-secondary' : 'bg-light text-dark' %>">
          <%= role.protected? ? t('better_together.roles.protection_status.protected') :
                                t('better_together.roles.protection_status.unprotected') %>
        </span>
      </div>

      <p class="text-muted"><%= role.description.presence || t('globals.no_description') %></p>

      <div class="mb-3">
        <p class="text-muted mb-2"><%= t('better_together.roles.permissions.label') %></p>
        <% summary = role_permission_summary(role, limit: 4) %>
        <% if summary[:labels].any? %>
          <div class="d-flex flex-wrap gap-1">
            <% summary[:labels].each do |label| %>
              <span class="badge bg-light text-dark"><%= label %></span>
            <% end %>
            <% if summary[:remaining].positive? %>
              <span class="badge bg-secondary">
                <%= t('better_together.roles.permissions.more', count: summary[:remaining]) %>
              </span>
            <% end %>
          </div>
        <% else %>
          <span class="text-muted"><%= t('better_together.roles.permissions.none') %></span>
        <% end %>
      </div>

      <dl class="row mb-0">
        <dt class="col-5 text-muted"><%= role.class.human_attribute_name(:position) %></dt>
        <dd class="col-7 mb-0"><%= role.position %></dd>
      </dl>
    </div>
    <div class="card-footer bg-transparent border-0 pt-0">
      <div class="d-flex flex-wrap gap-2">
        <%= link_to role_path(role), class: 'btn btn-outline-info btn-sm', 'aria-label' => t('globals.show') do %>
          <i class="fas fa-eye"></i> <%= t('globals.show') %>
        <% end %>

        <% if policy(role).edit? %>
          <%= link_to edit_role_path(role), class: 'btn btn-outline-secondary btn-sm', 'aria-label' => t('globals.edit') do %>
            <i class="fas fa-edit"></i> <%= t('globals.edit') %>
          <% end %>
        <% end %>

        <% if policy(role).destroy? %>
          <%= link_to role_path(role),
                      method: :delete,
                      data: { turbo_method: :delete, turbo_confirm: t('roles.confirm_destroy') },
                      class: 'btn btn-outline-danger btn-sm',
                      'aria-label' => t('globals.destroy') do %>
            <i class="fas fa-trash-alt"></i> <%= t('globals.destroy') %>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
</div>
