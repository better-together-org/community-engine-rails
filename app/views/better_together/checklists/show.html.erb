<!-- app/views/better_together/checklists/show.html.erb -->

<% content_for :page_title do %>
  <%= @checklist.title.to_s %>
<% end %>

<div class="container my-3">
  <h1 class="mb-3"><%= @checklist.title %></h1>

  <div class="mb-3">
  <%= render 'shared/resource_toolbar',
         back_to_list_path: better_together.checklists_path(locale: I18n.locale),
         edit_path: (policy(@checklist).update? ? better_together.edit_checklist_path(@checklist, locale: I18n.locale) : nil),
         destroy_path: (policy(@checklist).destroy? ? better_together.checklist_path(@checklist, locale: I18n.locale) : nil),
         destroy_confirm: t('globals.are_you_sure') %>
  </div>

  <div>
    <div data-controller="better_together/checklist_items" data-better_together-checklist_items-checklist-id-value="<%= @checklist.id %>" class="card">
      <div class="card-body">
        <h5 class="mb-3"><%= t('better_together.checklists.show.items_title', default: 'Items') %></h5>

        <div id="<%= dom_id(@checklist, :checklist_items) %>" data-better_together-checklist_items-target="list">
          <ul class="list-group" role="list" aria-labelledby="checklist-items-list">
            <%= render partial: 'better_together/checklist_items/checklist_item', collection: @checklist.checklist_items.with_translations, as: :checklist_item %>
          </ul>
        </div>

        <% if policy(BetterTogether::ChecklistItem.new(checklist: @checklist)).create? %>
          <div class="mt-3" data-better_together-checklist_items-target="form">
            <% form_object = BetterTogether::ChecklistItem.new(checklist: @checklist) %>
            <%= render partial: 'better_together/checklist_items/form', locals: { form_object: form_object, form_url: better_together.checklist_checklist_items_path(@checklist, locale: I18n.locale) } %>
          </div>
        <% end %>

        <div id="<%= dom_id(@checklist, :streams) %>" aria-hidden="true"></div>
      </div>
    </div>
  </div>
</div>
