<% content_for :page_title, t('better_together.person_blocks.new.title') %>

<%= turbo_frame_tag "blocked-people-settings" do %>
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-md-8">
        <div class="card">
          <div class="card-header">
            <div class="d-flex justify-content-between align-items-center">
              <h4 class="mb-0"><%= t('better_together.person_blocks.new.title') %></h4>
            </div>
          </div>
          <div class="card-body">
            <%= form_with model: [@person_block], 
                          url: person_blocks_path(locale: locale), 
                          local: true,
                          data: { turbo_frame: "blocked-people-settings" } do |form| %>
              <div class="mb-3">
                <%= form.label :blocked_id, 
                              t('better_together.person_blocks.new.blocked_person_label'), 
                              class: 'form-label' %>
                <%= form.select :blocked_id, 
                               options_for_select([]), 
                               { prompt: t('better_together.person_blocks.new.blocked_person_prompt') },
                               { 
                                 class: 'form-select',
                                 required: true,
                                 data: {
                                   controller: "better-together--slim-select",
                                   "better-together--slim-select-options-value": {
                                     ajax: {
                                       url: search_person_blocks_path(locale: locale),
                                       fetch: true,
                                       delay: 300
                                     },
                                     searchPlaceholder: t('better_together.person_blocks.new.blocked_person_placeholder'),
                                     searchHighlight: true,
                                     closeOnSelect: true,
                                     allowDeselect: true
                                   }.to_json
                                 }
                               } %>
                <div class="form-text">
                  <%= t('better_together.person_blocks.new.blocked_person_help') %>
                </div>
              </div>

              <div class="d-flex justify-content-between">
                <%= link_to t('better_together.person_blocks.new.cancel'),
                            person_blocks_path(locale: locale),
                            class: 'btn btn-outline-secondary',
                            data: { turbo_frame: "blocked-people-settings" } %>
                <%= form.submit t('better_together.person_blocks.new.submit'), class: 'btn btn-danger' %>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
<% end %>
