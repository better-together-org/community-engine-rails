<!-- By Attribute Translation Records -->
<%= turbo_frame_tag :translations_by_attribute do %>
  <div class="row mb-4">
    <div class="col-12">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h3 class="h5 mb-0">
          <i class="fa-solid fa-tag me-2" aria-hidden="true"></i>
          <%= t('.by_attribute_title') %>
        </h3>
        
        <!-- Attribute Filter Dropdown -->
        <div class="dropdown">
          <button class="btn btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
            <i class="fa-solid fa-filter me-1"></i>
            <%= @attribute_filter || t('.select_attribute') %>
          </button>
          <ul class="dropdown-menu">
            <% @available_attributes.each do |attribute| %>
              <li>
                <%= link_to better_together.by_attribute_translations_path(attribute: attribute),
                           class: "dropdown-item #{'active' if attribute == @attribute_filter}",
                           data: { turbo_frame: :translations_by_attribute } do %>
                  <%= attribute %>
                <% end %>
              </li>
            <% end %>
          </ul>
        </div>
      </div>

      <!-- Results Count -->
      <% if @attribute_filter %>
        <div class="alert alert-info">
          <i class="fa-solid fa-info-circle me-2"></i>
          <%= t('.showing_records_for_attribute', attribute: @attribute_filter, count: @translations.total_count) %>
        </div>
      <% end %>

      <!-- Translation Records Table -->
      <% if @translations&.any? %>
        <div class="card">
          <div class="card-body">
            <div class="table-responsive">
              <table class="table table-striped table-hover">
                <thead class="table-dark">
                  <tr>
                    <th><%= t('.model_type') %></th>
                    <th><%= t('.record_id') %></th>
                    <th><%= t('.locale') %></th>
                    <th><%= t('.data_type') %></th>
                    <th><%= t('.value') %></th>
                    <th><%= t('.actions') %></th>
                  </tr>
                </thead>
                <tbody>
                  <% @translations.each do |translation| %>
                    <tr>
                      <td>
                        <span class="badge bg-secondary">
                          <%= translation[:model_type] %>
                        </span>
                      </td>
                      <td>
                        <code><%= translation[:translatable_id] %></code>
                      </td>
                      <td>
                        <span class="badge bg-info">
                          <%= format_locale_display(translation[:locale]) %>
                        </span>
                      </td>
                      <td>
                        <span class="badge bg-<%= data_type_color(translation[:data_type]) %>">
                          <%= t("translations.index.data_type_names.#{translation[:data_type]}") %>
                        </span>
                      </td>
                      <td>
                        <div class="text-truncate" style="max-width: 300px;" title="<%= translation[:full_value] %>">
                          <%= translation[:value] %>
                        </div>
                      </td>
                      <td>
                        <div class="btn-group" role="group">
                          <button type="button" class="btn btn-sm btn-outline-info" data-bs-toggle="tooltip" title="<%= t('.view_full') %>">
                            <i class="fa-solid fa-eye"></i>
                          </button>
                        </div>
                      </td>
                    </tr>
                  <% end %>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Pagination -->
        <div class="d-flex justify-content-center mt-4">
          <%= paginate @translations, 
              params: { attribute: @attribute_filter },
              remote: true,
              data: { turbo_frame: :translations_by_attribute } %>
        </div>
      <% else %>
        <div class="alert alert-warning">
          <i class="fa-solid fa-exclamation-triangle me-2"></i>
          <% if @attribute_filter %>
            <%= t('.no_translations_for_attribute', attribute: @attribute_filter) %>
          <% else %>
            <%= t('.select_attribute_first') %>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>
<% end %>